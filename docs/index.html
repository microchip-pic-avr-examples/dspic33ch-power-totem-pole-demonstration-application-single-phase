<!-- HTML header for doxygen 1.8.20-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3.8/7.6 kw Totem pole Demonstration Application: 3.8/7.6 kw Totem pole Demonstration Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mchp.css" rel="stylesheet" type="text/css"/>
<link href="mchp_theme.css" rel="stylesheet" type="text/css"/>
<link href="search.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="border:0px; border-spacing: 0px; border-collapse: collapse; vertical-align: middle; width: 100%;">
    <tbody>
        <tr style="border: none; background-color: #00000000;">
            <!--SITE HEADER-->
            <td style="width: 120px; border: none;">
                <img alt="Bar" height="60px" src="images/mchp-brandingelement-rgb2.png"/>
            </td>
            <td style="width: 220px; border: none;">
                <img alt="Logo" height=50px src="images/microchip.png"/>
            </td>
            <td colspan="4" style="font-size: 16pt; font-weight: bolder;">
                3.8/7.6 kw Totem pole Demonstration Application (Part-No. (not specified)) 
            </td>
            <td style="text-align: right; vertical-align: middle;">
                        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
            </td>
            <!--END SITE HEADER-->
        </tr>
        <tr style="height:36px; border:none; background-color: #000000b0;">
            <td style="width: 70px; color: white; font-size:14px; font-weight: bolder; margin-left: 30px;">
                <div style="margin-left: 30px;">Content</div>
            </td>
            <td style="width: 10px; color: white; font-size:14px; font-weight: bolder;">
                &nbsp;
            </td>
            <td style="width: 100px; color: white; font-size:14px; font-weight: bolder;">
                <!-- Overview -->
            </td>
            <td style="width: 130px; color: white; font-size:14px; font-weight: bolder;"> 
                <!-- Documentation -->
            </td>
            <td style="width: 170px; color: white; font-size:14px; font-weight: bolder;"> 
                <!-- Additional Resources -->
            </td>
            <td style="width: auto; color: white; font-size:14px; font-weight: bolder;"> 
              &nbsp;
            </td>
            <td style="width: 310px; margin-right: 30px; color: white; font-size:10px; font-weight: lighter; text-align: right;">
                &nbsp;
            </td>
        </tr>
    </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">3.8/7.6 kw Totem pole Demonstration Application </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__c_1_2_users_2_m70027_2_documents_2_projects_2tp-deployment_2dspic33ch-power-totem-pole-demonstration-application-single-phase__v2_2_r_e_a_d_m_e"></a> <img src="microchip.png" alt="" class="inline"/>    </p>
<hr  />
 <h1><a class="anchor" id="autotoc_md1"></a>
3.8kW / 7.6kW dsPIC33C Totem Pole Demonstration Application</h1>
<div class="image">
<img src="dsPIC33C_TP_DA_s.png" alt=""/>
<div class="caption">
3.8kW / 7.6 kW dsPIC33 Totem Pole Demonstration Application</div></div>
    <h2><a class="anchor" id="autotoc_md2"></a>
Introduction</h2>
<p>The dsPIC33C Totem Pole Demonstrator platform, based on Microchips dsPIC33C and Silicon Carbide (SiC) devices, supports rapid prototyping and code development for high voltage Single Phase PFC/Grid Tied Inverters(GTI). The primary target application is automotive On-board chargers (OBC), but it can be used for any other industrial or telecom application that requires high power PFC/GTI. <br  />
</p>
<p>This readme aims to provide a quick start guide in controlling and running the PFC and GTI, once the hardware is setup and electrical connections are made.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Highlights</h2>
<ul>
<li>Supports the following operating modes at both low voltage and high voltage<ul>
<li>Single phase PFC with two legs interleaved</li>
<li>Single phase voltage inverter</li>
<li>Forward operation, current mode</li>
</ul>
</li>
<li>CAN communication to PC running Power Board Visualizer GUI</li>
<li>SPI communication to Isolated Voltage Acquisition Board</li>
<li>I2C communication to PIC16 on main power board (for housekeeping)</li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
Related Collaterals</h2>
<h3>Firmware Documentation</h3>
<p><a href="https://microchip-pic-avr-examples.github.io/dspic33ch-power-totem-pole-demonstration-application-single-phase/">Online Firmware Documentation of this Code Example</a></p>
<h3>Hardware Used</h3>
<ul>
<li>dsPIC33C Totem Pole PFC Development Platform<ul>
<li>Power Board</li>
<li>Isolated Voltage Acquisition Board</li>
<li>SiC FET PIM</li>
</ul>
</li>
</ul>
<p><b>Hardware Documentation</b></p>
<ul>
<li>dsPIC33C Totem Pole PFC Development Board User's Guide</li>
<li>Isolated Voltage Acquisition Board User’s Guide</li>
<li>SiC FET Plug-In Module (SiC FET PIM) User’s Guide</li>
<li>Operational Manuals</li>
</ul>
<p><b>Target Device Documentation</b></p>
<ul>
<li><a href="https://www.microchip.com/en-us/product/dsPIC33CH512MP506">dsPIC33CH512MP506 Family Data Sheet</a></li>
<li><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/dsPIC33CH512MP508-Family-Silicon-Errata-and-Data-Sheet-Clarification-DS80000805K.pdf">dsPIC33CH512MP506 Family Silicon Errata and Data Sheet Clarification</a></li>
<li><a href="https://www.microchip.com/dsPIC33CH512MP508">dsPIC33CH512MP508 Family</a></li>
</ul>
<p><b>Please always check for the latest data sheets on the respective product websites:</b></p>
<h2><a class="anchor" id="autotoc_md5"></a>
Software Used</h2>
<ul>
<li><a href="https://www.microchip.com/mplabx-ide-windows-installer">MPLAB&reg; X IDE v6.20</a></li>
<li><a href="https://www.microchip.com/en-us/tools-resources/archives/mplab-ecosystem">MPLAB&reg; XC-DSC Compiler v3.10</a></li>
<li><a href="https://www.microchip.com/mplab/mplab-code-configurator">Microchip Code Configurator v5.7.0</a></li>
<li><a href="https://www.microchip.com/en-us/solutions/power-management-and-conversion/intelligent-power/mplab-powersmart-development-suite">MPLAB® PowerSmart™ Development Suite</a></li>
<li><a href="https://www.microchip.com/developmenttools/ProductDetails/DCDT">Digital Compensator Design Tool</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
Directory Structure</h2>
<p>Note that there are two MPLABx projects associated with this project, one for the primary core and one for the secondary core.</p>
<div class="fragment"><div class="line">├───dspic33ch_totem_pole_single_phase_primary_IL.X      dspic33ch512mp506 Primary core Project</div>
<div class="line">├───dspic33ch_totem_pole_single_phase_secondary_IL.X    dspic33ch512mp506 Secondary core Project</div>
<div class="line">├───images                                           Images for the Readme</div>
<div class="line">├───power_board_visualizer_xmls                      Power Board Visualizer Projects</div>
<div class="line">├───pre_compiled_hex_files                           Pre compiled Hex files for PFC and GTI modes</div>
<div class="line">└───sources_common                                   Common Sources between both projects</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Programming Hex File using available hex files</h2>
<p>In this example ICD4 is being used, but any of the available debuggers/programmers can be used.</p>
<ol type="1">
<li>Open MPLAB X IPE</li>
<li>Select the device on DP-PIM : dsPIC33CH512MP506 (not S1)</li>
<li>Memory Model : Single Partition</li>
<li>Connect computer to ICD4 via USB cable, connect ICD4 to 6 pin header on DP-PIM via RJ11 cable and RJ11 to ICSP adapter.</li>
<li>Power the dpPIM through a microUSB cable.</li>
<li>Click connect on the MPLAB X IPE</li>
<li>Wait for the device to connect</li>
<li>Navigate to the folder pre_compiled_hex_files, and select the correct hex file</li>
<li>Click program</li>
<li>Wait for the program/verify complete message.</li>
<li>Disconnect programmer from Digital Power Plug-in Module. <br  />
</li>
</ol>
<h2><a class="anchor" id="autotoc_md8"></a>
Quick Start Guide</h2>
<p>This Section will guide you on how to run and control the PFC or GTI application using power board visualizer, once the electrical connections are made.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Hardware Setup</h2>
<p>Please refer to the operational manual on PFC hardware setup considerations. Ensure the correct load and source selection has been made. This readme does not cover the electrical setup for the Totempole Application board.</p>
<p>To enable the CAN commuincation from the PC to Totem pole application board a USB to CAN dongle is needed. Note that the Power Board Visualizer can only work with PEAK System USB CAN-FD dongles. You can use a RS232 DB9 Straight Through cable to connect the Totempole board to PEAK dongle.</p>
<div class="image">
<img src="pfc-setup.png" alt=""/>
<div class="caption">
3.8kW / 7.6 kW dsPIC33 Totem Pole PFC Hardware Setup Overview</div></div>
    <div class="image">
<img src="inverter-setup.png" alt=""/>
<div class="caption">
3.8kW / 7.6 kW dsPIC33 Totem Pole GTI Hardware Setup Overview</div></div>
    <h2><a class="anchor" id="autotoc_md10"></a>
Powering On board through Power Board Visualizer</h2>
<h3>Prequisites</h3>
<p>Following software must be installed on your pc to control/communicate between Power Board Visualizer and dsPIC33CH.</p>
<ul>
<li><a href="https://www.microchip.com/en-us/software-library/power_board_visualizer">Power Board Visualizer V2</a></li>
<li><a href="https://www.peak-system.com/Drivers.523.0.html?&amp;L=1&amp;gad_source=1&amp;gclid=EAIaIQobChMI45n6jYW1hQMVgBatBh3uEgOhEAAYASAAEgJEm_D_BwE">Peak System USB Drivers</a></li>
</ul>
<h3>Setting up and Connecting the Power Board Visualizer</h3>
<p>Once the hardware setup is all done, Navigate to the power board visualizer xmls folder. Open the relevant project using Power Board Visualizer. Here PFC mode is taken as an example. Once the project is open you will be greeted by the following screen. <br  />
</p>
<div class="image">
<img src="pbv_open_s.png" alt=""/>
<div class="caption">
![PFC project running on Power Board Visualizer GUI ](images/pbv_open_s.png "PFC project running on Power Board Visualizer GUI ")</div></div>
    <h4>1. Start Stop Button</h4>
<p>This button turns on and off the application. Each button corresonds to a message over CANFD. Click on Info tab for CAN message description.</p>
<h4>2. Vout/Iout Ref Slider</h4>
<p>This slider is used to set a output voltage/current referece for the PFC/GTI. Its important to press Set button underneath the slider to communicate the reference value to the micrcontroller.</p>
<h4>3. Comm Status and COM Selector</h4>
<p>The "COM?" button lists all the available commuincation ports available to the PBV. If the Peak Dongle drivers are installed and the Peak USB dongle is connected to the system, then you will see the Peak USB dongle listed here as PCAN_USB:FD. Select the right port and then click enable. Power Board Visualizer will then open the Comm port.</p>
<h4>4. Vac Status Flags</h4>
<p>This Status group lists the Line AC voltage Status word.</p>
<h4>5. PFC Controller State</h4>
<p>This controller status group communicates the current state of the system. More information on what each state does, and statemachine can be found in state machine overview in detail.</p>
<h4>6. PFC Status Flags</h4>
<p>This Status flag group lists the current mode, and highlevel state of the system.</p>
<h4>7. Housekeeping Flags</h4>
<p>Thie status group lists the health and communication of SiC cards, as well as the Auxillary supplies. <br  />
</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Sequence of Actions to Power On</h2>
<p>After opening the right Power board Visualizer Project, following sequence of actions are to be taken to start the board</p>
<ol type="1">
<li>Select the right comm port and enable the port.</li>
<li>If everything is setup correctly, you will see some status/housekeeping data, and the system in PCS_STANDBY state. Confirm that the right operation Mode is programmed by looking at the Status Flags.</li>
<li>Change reference voltage/current if needed.</li>
<li>Click on Start. The system will jump quickly through the states, and then should land on PCS_UP_AND_RUNNING.</li>
</ol>
<div class="image">
<img src="PoBoV_PFC_s.JPG" alt=""/>
<div class="caption">
PFC Up and Running </div></div>
    <div class="image">
<img src="PoBoV_GTI_s.JPG" alt=""/>
<div class="caption">
GTI Up and Running </div></div>
     </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.20-->
<!-- start footer part -->
<div id="nav-path" class="navpath" style="padding-bottom: 12px; vertical-align: bottom;"><!-- id is needed for treeview function! -->
  <ul>
    <p class="footer" style="text-align: center; font-size: 90%;">
      © Copyright 1998-2022 Microchip Technology Inc. All rights reserved.
    </p>
    </ul>
</div>
</body>
</html>
